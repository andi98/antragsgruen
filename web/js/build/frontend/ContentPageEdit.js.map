{"version":3,"sources":["frontend/ContentPageEdit.ts"],"names":["editor","CKEDITOR","ContentPageEdit","$page","this","$form","find","$textSaver","$textHolder","$editCaller","click","editCalled","bind","addClass","save","prototype","ev","preventDefault","attr","inline","scayt_sLang","removePlugins","focus","removeClass","_this","$","post","data","getData","_csrf","val","ret","window","setTimeout","destroy","alert","each"],"mappings":"AAAA,IAAOA,OAASC,SAASD,OAEzBE,gBAAA,WAOI,SAAAA,EAAoBC,GAAAC,KAAAD,MAAAA,EAChBC,KAAKC,MAAQF,EAAMG,KAAK,UACxBF,KAAKG,WAAaH,KAAKC,MAAMC,KAAK,gBAClCF,KAAKI,YAAcJ,KAAKC,MAAMC,KAAK,iBACnCF,KAAKK,YAAcN,EAAMG,KAAK,iBAE9BF,KAAKK,YAAYC,MAAMN,KAAKO,WAAWC,KAAKR,OAC5CA,KAAKG,WAAWM,SAAS,UACzBT,KAAKG,WAAWD,KAAK,UAAUI,MAAMN,KAAKU,KAAKF,KAAKR,OAqC5D,OAlCYF,EAAAa,UAAAJ,WAAR,SAAmBK,GACfA,EAAGC,iBACHb,KAAKK,YAAYI,SAAS,UAC1BT,KAAKI,YAAYU,KAAK,kBAAmB,QAEzCd,KAAKJ,OAASC,SAASkB,OAAOf,KAAKI,YAAYU,KAAK,OAChDE,YAAa,QACbC,cAAe,SAGnBjB,KAAKI,YAAYc,QACjBlB,KAAKG,WAAWgB,YAAY,WAGxBrB,EAAAa,UAAAD,KAAR,SAAaE,GAAb,IAAAQ,EAAApB,KACIY,EAAGC,iBAEHQ,EAAEC,KAAKtB,KAAKC,MAAMa,KAAK,WACnBS,KAAQvB,KAAKJ,OAAO4B,UACpBC,MAASzB,KAAKC,MAAMC,KAAK,uBAAuBwB,OACjD,SAACC,GACW,KAAPA,GACAC,OAAOC,WAAW,WACdT,EAAKxB,OAAOkC,WACb,KACHV,EAAKjB,WAAWM,SAAS,UACzBW,EAAKhB,YAAYU,KAAK,kBAAmB,SACzCM,EAAKf,YAAYc,YAAY,WAE7BY,MAAM,8BAKtBjC,EApDA,GAsDAuB,EAAE,gBAAgBW,KAAK,WACnB,IAAIlC,gBAAgBuB,EAAErB","file":"ContentPageEdit.js","sourcesContent":["import editor = CKEDITOR.editor;\n\nclass ContentPageEdit {\n    private $editCaller: JQuery;\n    private $textHolder: JQuery;\n    private $textSaver: JQuery;\n    private $form: JQuery;\n    private editor: editor;\n\n    constructor(private $page: JQuery) {\n        this.$form = $page.find('> form');\n        this.$textSaver = this.$form.find('> .textSaver');\n        this.$textHolder = this.$form.find('> .textHolder');\n        this.$editCaller = $page.find('> .editCaller');\n\n        this.$editCaller.click(this.editCalled.bind(this));\n        this.$textSaver.addClass(\"hidden\");\n        this.$textSaver.find('button').click(this.save.bind(this));\n    }\n\n    private editCalled(ev) {\n        ev.preventDefault();\n        this.$editCaller.addClass(\"hidden\");\n        this.$textHolder.attr('contenteditable', \"true\");\n\n        this.editor = CKEDITOR.inline(this.$textHolder.attr('id'), {\n            scayt_sLang: 'de_DE',\n            removePlugins: 'lite'\n        });\n\n        this.$textHolder.focus();\n        this.$textSaver.removeClass('hidden');\n    }\n\n    private save(ev) {\n        ev.preventDefault();\n\n        $.post(this.$form.attr('action'), {\n            'data': this.editor.getData(),\n            '_csrf': this.$form.find('> input[name=_csrf]').val()\n        }, (ret) => {\n            if (ret == '1') {\n                window.setTimeout(() => {\n                    this.editor.destroy();\n                }, 100);\n                this.$textSaver.addClass('hidden');\n                this.$textHolder.attr('contenteditable', 'false');\n                this.$editCaller.removeClass('hidden');\n            } else {\n                alert('Something went wrong...');\n            }\n        })\n\n    }\n}\n\n$('.contentPage').each(function () {\n    new ContentPageEdit($(this));\n});\n"]}